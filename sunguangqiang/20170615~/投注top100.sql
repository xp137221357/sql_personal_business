帮我查个数据：
7.1 00：00-7.18 12：00
投注金币最多 Top 100的用户
昵称 会员号  投注金币数 返奖金币数 总充值金币 官充金币 第三方充金币  最后一次打开app时间
set @param0='2017-07-01';
set @param1='2017-07-19';


select * from (
	select * from (
		select o.USER_ID,sum(o.COIN_BUY_MONEY) bet_coins,
		ifnull(sum(o.COIN_PRIZE_MONEY),0)+ifnull(sum(o.COIN_RETURN_MONEY),0) prize_coins 
		from game.t_order_item o 
		where o.CHANNEL_CODE in ('game','jrtt-jingcai')
		and o.ITEM_STATUS not in (-5,-10,210)
		and o.PAY_TIME >=@param0
		and o.PAY_TIME < @param1
		and o.COIN_BUY_MONEY>0
		group by o.USER_ID
	) t order by t.bet_coins desc
	limit 100
) tt order by tt.USER_ID asc;



select 
t.NICK_NAME '昵称',
t.ACCT_NUM '会员好',
t.USER_CODE '用户ID',
t.buy_coins '总充值金币',
t.app_coins '官方充值金币',
t.buy_coins-t.app_coins '第三方充值金币'
from (
	select 
	u.NICK_NAME,
	u.ACCT_NUM,
	u.USER_CODE,
	ifnull(sum(tc.coins),0) buy_coins,
	ifnull(sum(if(tc.charge_method='app',tc.coins,0)),0) app_coins
	from forum.t_user u
	left join report.t_trans_user_recharge_coin tc on tc.charge_user_id=u.USER_ID and tc.CRT_TIME >=@param0 and tc.CRT_TIME < @param1
	where u.USER_CODE in (
	
'1182366575757439098',
'1239488965254781608',
'1267599704478678650',
'1295861073559984884',
'1341695586477610908',
'1382672235244783505',
'1493887307853788723',
'1781325346160762874',
'1984245295347165709',
'2132748802352702684',
'2149752473673243320',
'2251906180245334251',
'2257162127081908401',
'2472356626248847879',
'2564248409799858887',
'2673984862772118300',
'2729544441809613518',
'2794180072552128107',
'3197844359848185549',
'3298437304995097892',
'3341854982522646056',
'3346720280389625849',
'3356877449304417135',
'3372643570522772972',
'3438762221264554851',
'3463283333115014775',
'3471655137293976454',
'3489232453627020953',
'3537283784879404928',
'3547812794649357190',
'3586732012577234189',
'3617283297604229261',
'3895267485350000665',
'3897133260027326147',
'3941366295244766817',
'4251794747502028795',
'4412584977957305665',
'4482568346322358889',
'4672347546077957375',
'4741982181922185722',
'4753924819465269650',
'4782359224632500061',
'4783691097159607136',
'4785926867646614843',
'4816240086707221610',
'4826319022900086991',
'4842175857109620791',
'4941564923525926439',
'4965788553250272516',
'4968426021975361455',
'5276412407132541093',
'5472354944362629580',
'5538440070358395485',
'5591871550439607647',
'5615760486139386158',
'5652470892238788624',
'5697151513514554367',
'5915671527413163300',
'5928742960622998041',
'6157904715290509354',
'6219505352866111858',
'6296309683481175896',
'6372505834448680210',
'6374601740748671567',
'6379205729980978358',
'6468903504898071257',
'6487906878441726048',
'6534211314775757148',
'6758603171456709827',
'6879600012790291154',
'6975116441388973461',
'7138045732065786377',
'7279061853967320027',
'7453028894268620972',
'7549080938598132178',
'7562039357149820760',
'7612035781280929410',
'7615032321961011948',
'7623057880224757828',
'7653094043560074352',
'7764020631066818086',
'7783014384020590700',
'7861041281623790284',
'7864055515809796814',
'7942082429048897076',
'7947023320373569600',
'8160832913211566216',
'8180322816580355093',
'8210773901740861971',
'8210793989226555560',
'8270955124623600907',
'8380574846740410205',
'8570356994695319543',
'8580347094241407376',
'8620419508556330133',
'8650367125937904832',
'8760425170325559462',
'8790630501014389458',
'8930263304717753940',
'8940517273391882024'

	)
	
	group by u.user_id
) t order by t.USER_CODE asc;


-- 最后一次打开app时间

select * from (
	select u.USER_CODE,t.CRT_TIME
	from forum.t_user u
	inner join forum.t_user_event t on u.USER_ID=t.USER_ID
		where u.USER_CODE in (
		'1182366575757439098',
'1239488965254781608',
'1267599704478678650',
'1295861073559984884',
'1341695586477610908',
'1382672235244783505',
'1493887307853788723',
'1781325346160762874',
'1984245295347165709',
'2132748802352702684',
'2149752473673243320',
'2251906180245334251',
'2257162127081908401',
'2472356626248847879',
'2564248409799858887',
'2673984862772118300',
'2729544441809613518',
'2794180072552128107',
'3197844359848185549',
'3298437304995097892',
'3341854982522646056',
'3346720280389625849',
'3356877449304417135',
'3372643570522772972',
'3438762221264554851',
'3463283333115014775',
'3471655137293976454',
'3489232453627020953',
'3537283784879404928',
'3547812794649357190',
'3586732012577234189',
'3617283297604229261',
'3895267485350000665',
'3897133260027326147',
'3941366295244766817',
'4251794747502028795',
'4412584977957305665',
'4482568346322358889',
'4672347546077957375',
'4741982181922185722',
'4753924819465269650',
'4782359224632500061',
'4783691097159607136',
'4785926867646614843',
'4816240086707221610',
'4826319022900086991',
'4842175857109620791',
'4941564923525926439',
'4965788553250272516',
'4968426021975361455',
'5276412407132541093',
'5472354944362629580',
'5538440070358395485',
'5591871550439607647',
'5615760486139386158',
'5652470892238788624',
'5697151513514554367',
'5915671527413163300',
'5928742960622998041',
'6157904715290509354',
'6219505352866111858',
'6296309683481175896',
'6372505834448680210',
'6374601740748671567',
'6379205729980978358',
'6468903504898071257',
'6487906878441726048',
'6534211314775757148',
'6758603171456709827',
'6879600012790291154',
'6975116441388973461',
'7138045732065786377',
'7279061853967320027',
'7453028894268620972',
'7549080938598132178',
'7562039357149820760',
'7612035781280929410',
'7615032321961011948',
'7623057880224757828',
'7653094043560074352',
'7764020631066818086',
'7783014384020590700',
'7861041281623790284',
'7864055515809796814',
'7942082429048897076',
'7947023320373569600',
'8160832913211566216',
'8180322816580355093',
'8210773901740861971',
'8210793989226555560',
'8270955124623600907',
'8380574846740410205',
'8570356994695319543',
'8580347094241407376',
'8620419508556330133',
'8650367125937904832',
'8760425170325559462',
'8790630501014389458',
'8930263304717753940',
'8940517273391882024'
	) order by t.CRT_TIME desc
)tt group by tt.USER_CODE;




-- 最后一次打开app时间

select * from (
	select u.USER_CODE,t.STAT_TIME
	from forum.t_user u
	inner join report.t_stat_user_online t on u.USER_ID=t.USER_ID
		where u.USER_CODE in (
		'1182366575757439098',
'1239488965254781608',
'1267599704478678650',
'1295861073559984884',
'1341695586477610908',
'1382672235244783505',
'1493887307853788723',
'1781325346160762874',
'1984245295347165709',
'2132748802352702684',
'2149752473673243320',
'2251906180245334251',
'2257162127081908401',
'2472356626248847879',
'2564248409799858887',
'2673984862772118300',
'2729544441809613518',
'2794180072552128107',
'3197844359848185549',
'3298437304995097892',
'3341854982522646056',
'3346720280389625849',
'3356877449304417135',
'3372643570522772972',
'3438762221264554851',
'3463283333115014775',
'3471655137293976454',
'3489232453627020953',
'3537283784879404928',
'3547812794649357190',
'3586732012577234189',
'3617283297604229261',
'3895267485350000665',
'3897133260027326147',
'3941366295244766817',
'4251794747502028795',
'4412584977957305665',
'4482568346322358889',
'4672347546077957375',
'4741982181922185722',
'4753924819465269650',
'4782359224632500061',
'4783691097159607136',
'4785926867646614843',
'4816240086707221610',
'4826319022900086991',
'4842175857109620791',
'4941564923525926439',
'4965788553250272516',
'4968426021975361455',
'5276412407132541093',
'5472354944362629580',
'5538440070358395485',
'5591871550439607647',
'5615760486139386158',
'5652470892238788624',
'5697151513514554367',
'5915671527413163300',
'5928742960622998041',
'6157904715290509354',
'6219505352866111858',
'6296309683481175896',
'6372505834448680210',
'6374601740748671567',
'6379205729980978358',
'6468903504898071257',
'6487906878441726048',
'6534211314775757148',
'6758603171456709827',
'6879600012790291154',
'6975116441388973461',
'7138045732065786377',
'7279061853967320027',
'7453028894268620972',
'7549080938598132178',
'7562039357149820760',
'7612035781280929410',
'7615032321961011948',
'7623057880224757828',
'7653094043560074352',
'7764020631066818086',
'7783014384020590700',
'7861041281623790284',
'7864055515809796814',
'7942082429048897076',
'7947023320373569600',
'8160832913211566216',
'8180322816580355093',
'8210773901740861971',
'8210793989226555560',
'8270955124623600907',
'8380574846740410205',
'8570356994695319543',
'8580347094241407376',
'8620419508556330133',
'8650367125937904832',
'8760425170325559462',
'8790630501014389458',
'8930263304717753940',
'8940517273391882024'
	) order by t.STAT_TIME desc
)tt group by tt.USER_CODE;



-- 上一级代理

select * from(
	select u.USER_CODE from forum.t_user u 
	where u.USER_CODE in (
	
	'1182366575757439098',
	'1239488965254781608',
	'1267599704478678650',
	'1295861073559984884',
	'1341695586477610908',
	'1382672235244783505',
	'1493887307853788723',
	'1781325346160762874',
	'1984245295347165709',
	'2132748802352702684',
	'2149752473673243320',
	'2251906180245334251',
	'2257162127081908401',
	'2472356626248847879',
	'2564248409799858887',
	'2673984862772118300',
	'2729544441809613518',
	'2794180072552128107',
	'3197844359848185549',
	'3298437304995097892',
	'3341854982522646056',
	'3346720280389625849',
	'3356877449304417135',
	'3372643570522772972',
	'3438762221264554851',
	'3463283333115014775',
	'3471655137293976454',
	'3489232453627020953',
	'3537283784879404928',
	'3547812794649357190',
	'3586732012577234189',
	'3617283297604229261',
	'3895267485350000665',
	'3897133260027326147',
	'3941366295244766817',
	'4251794747502028795',
	'4412584977957305665',
	'4482568346322358889',
	'4672347546077957375',
	'4741982181922185722',
	'4753924819465269650',
	'4782359224632500061',
	'4783691097159607136',
	'4785926867646614843',
	'4816240086707221610',
	'4826319022900086991',
	'4842175857109620791',
	'4941564923525926439',
	'4965788553250272516',
	'4968426021975361455',
	'5276412407132541093',
	'5472354944362629580',
	'5538440070358395485',
	'5591871550439607647',
	'5615760486139386158',
	'5652470892238788624',
	'5697151513514554367',
	'5915671527413163300',
	'5928742960622998041',
	'6157904715290509354',
	'6219505352866111858',
	'6296309683481175896',
	'6372505834448680210',
	'6374601740748671567',
	'6379205729980978358',
	'6468903504898071257',
	'6487906878441726048',
	'6534211314775757148',
	'6758603171456709827',
	'6879600012790291154',
	'6975116441388973461',
	'7138045732065786377',
	'7279061853967320027',
	'7453028894268620972',
	'7549080938598132178',
	'7562039357149820760',
	'7612035781280929410',
	'7615032321961011948',
	'7623057880224757828',
	'7653094043560074352',
	'7764020631066818086',
	'7783014384020590700',
	'7861041281623790284',
	'7864055515809796814',
	'7942082429048897076',
	'7947023320373569600',
	'8160832913211566216',
	'8180322816580355093',
	'8210773901740861971',
	'8210793989226555560',
	'8270955124623600907',
	'8380574846740410205',
	'8570356994695319543',
	'8580347094241407376',
	'8620419508556330133',
	'8650367125937904832',
	'8760425170325559462',
	'8790630501014389458',
	'8930263304717753940',
	'8940517273391882024'
	)
	
)tt1
left join (
	select t1.USER_ID,t3.agent from game.t_group_ref t1 
	left join game.t_group_ref t2 on t1.ROOT_ID=t2.REF_ID
	left join forum.t_user u on t2.USER_ID=u.USER_CODE
	left join report.t_partner_group t3 on u.ACCT_NUM=t3.agent_acct_num and t3.is_valid=0
	
	where t1.USER_ID in (
	
	'1182366575757439098',
	'1239488965254781608',
	'1267599704478678650',
	'1295861073559984884',
	'1341695586477610908',
	'1382672235244783505',
	'1493887307853788723',
	'1781325346160762874',
	'1984245295347165709',
	'2132748802352702684',
	'2149752473673243320',
	'2251906180245334251',
	'2257162127081908401',
	'2472356626248847879',
	'2564248409799858887',
	'2673984862772118300',
	'2729544441809613518',
	'2794180072552128107',
	'3197844359848185549',
	'3298437304995097892',
	'3341854982522646056',
	'3346720280389625849',
	'3356877449304417135',
	'3372643570522772972',
	'3438762221264554851',
	'3463283333115014775',
	'3471655137293976454',
	'3489232453627020953',
	'3537283784879404928',
	'3547812794649357190',
	'3586732012577234189',
	'3617283297604229261',
	'3895267485350000665',
	'3897133260027326147',
	'3941366295244766817',
	'4251794747502028795',
	'4412584977957305665',
	'4482568346322358889',
	'4672347546077957375',
	'4741982181922185722',
	'4753924819465269650',
	'4782359224632500061',
	'4783691097159607136',
	'4785926867646614843',
	'4816240086707221610',
	'4826319022900086991',
	'4842175857109620791',
	'4941564923525926439',
	'4965788553250272516',
	'4968426021975361455',
	'5276412407132541093',
	'5472354944362629580',
	'5538440070358395485',
	'5591871550439607647',
	'5615760486139386158',
	'5652470892238788624',
	'5697151513514554367',
	'5915671527413163300',
	'5928742960622998041',
	'6157904715290509354',
	'6219505352866111858',
	'6296309683481175896',
	'6372505834448680210',
	'6374601740748671567',
	'6379205729980978358',
	'6468903504898071257',
	'6487906878441726048',
	'6534211314775757148',
	'6758603171456709827',
	'6879600012790291154',
	'6975116441388973461',
	'7138045732065786377',
	'7279061853967320027',
	'7453028894268620972',
	'7549080938598132178',
	'7562039357149820760',
	'7612035781280929410',
	'7615032321961011948',
	'7623057880224757828',
	'7653094043560074352',
	'7764020631066818086',
	'7783014384020590700',
	'7861041281623790284',
	'7864055515809796814',
	'7942082429048897076',
	'7947023320373569600',
	'8160832913211566216',
	'8180322816580355093',
	'8210773901740861971',
	'8210793989226555560',
	'8270955124623600907',
	'8380574846740410205',
	'8570356994695319543',
	'8580347094241407376',
	'8620419508556330133',
	'8650367125937904832',
	'8760425170325559462',
	'8790630501014389458',
	'8930263304717753940',
	'8940517273391882024'
	
	)
) tt2 on tt1.user_code=tt2.user_id
order by tt1.user_code asc;















